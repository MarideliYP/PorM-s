{% extends 'base2.html' %}
{% load static %}

<!-- ======= Header ======= -->
<header id="header" class="fixed-top d-flex align-items-center">
  <div class="container-fluid container-xl d-flex align-items-center justify-content-lg-between">
    <a href="{% url 'vistaprincipal' %}" class="book-a-table-btn scrollto d-none d-lg-flex">Volver</a>
  </div>
</header>

{% block content %}
<section id="contact" class="contact">
  <div class="form-container">
    <h1>Añadir Reserva para {{ evento.nombreE }}</h1>
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <!-- Campos que ve cualquier usuario -->
      {% for field in form %}
        {% if field.name != 'estado' %}
          <div class="form-group mt-3">
            <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
            {{ field }}
            {% if field.errors %}
              <div class="alert alert-danger small mt-1">
                {{ field.errors|first }}
              </div>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}

      <!-- Campo 'estado' - Solo para staff o admin -->
      {% if user.is_staff or user.is_superuser %}
        <div class="form-group mt-4 p-3 border-top" style="border-color: #444 !important;">
          <div class="form-check">
            {% for field in form %}
              {% if field.name == 'estado' %}
                {{ field }}
                <label class="form-check-label ms-2" for="{{ field.id_for_label }}">
                  <strong>{{ field.label }}</strong>
                </label>
                {% if field.errors %}
                  <div class="alert alert-danger small mt-1">
                    {{ field.errors|first }}
                  </div>
                {% endif %}
              {% endif %}
            {% endfor %}
          </div>
        </div>
      {% endif %}

      <!-- Botón de envío -->
      <div class="d-flex justify-content-between">
          <a class="btn btn-danger mt-2" href="{% url 'producto:evento_detalle' evento.pk %}">Cancelar</a>
          <input type="submit" class="btn btn-primary mt-2" value="Guardar Reserva">
      </div>
    </form>
  </div>
</section>
{% endblock %}
